(self.webpackChunkultimate_jekyll=self.webpackChunkultimate_jekyll||[]).push([[6002,8367],{634:()=>{},938:()=>{},2480:()=>{},3005:()=>{},4050:()=>{},5043:()=>{},5460:(e,o,n)=>{"use strict";n.d(o,{A:()=>i});var t=n(4289),s=n.n(t);const i=async function(e,o={}){window.Manager;const t=JSON.parse(JSON.stringify(o)),{getAuth:i}=await Promise.all([n.e(9943),n.e(7480)]).then(n.bind(n,7480)),c=i().currentUser;if(!c)throw new Error("No authenticated user found");const a=await c.getIdToken();return t.headers||(t.headers={}),t.headers.Authorization="Bearer "+a,s()(e,t)}},6600:()=>{},7664:()=>{},8466:()=>{},9978:(e,o,n)=>{"use strict";n.r(o),n.d(o,{init:()=>u,loadData:()=>g,onShow:()=>f});var t=n(2984),s=n(5460);let i=null,c=null,a=null,r=new Map;const d=["google","discord","github","twitter","facebook"];function l(){return i.getApiUrl()+"/backend-manager"}async function u(e){i=e}async function g(e,o){e&&(a=e,c=o,m())}function m(){console.log("[DEBUG] displayConnections() called");const e=document.getElementById("connections-loading");if(e&&e.classList.add("d-none"),!c)return console.log("[DEBUG] No appData, showing loading state"),void(e&&e.classList.remove("d-none"));const o=c?.oauth2||{},n=a?.oauth2||{};console.log("[DEBUG] Available OAuth providers:",o),console.log("[DEBUG] User connections:",n);let i=!1;d.forEach(e=>{console.log(`[DEBUG] Processing provider: ${e}`);const d=o[e],u=document.getElementById(`connection-${e}`);if(console.log(`[DEBUG] ${e} - providerSettings:`,d),console.log(`[DEBUG] ${e} - providerSettings.enabled:`,d?.enabled),console.log(`[DEBUG] ${e} - $providerElement exists:`,!!u),!u)return void console.warn(`[DEBUG] ${e} - Provider element not found in DOM`);const g=d&&!1!==d.enabled;if(console.log(`[DEBUG] ${e} - isEnabled:`,g),g){i=!0,console.log(`[DEBUG] ${e} - Removing d-none class`),u.classList.remove("d-none"),console.log(`[DEBUG] ${e} - About to initialize FormManager`),function(e){const o=`connection-form-${e}`;if(!document.getElementById(o))return void console.warn(`Form not found for provider: ${e}`);if(r.has(e))return void console.log(`FormManager already initialized for ${e}`);console.log(`Initializing FormManager for ${e}`);const n=new t.A(`#${o}`,{autoDisable:!0,showSpinner:!0});r.set(e,n),n.addEventListener("statechange",o=>{const{status:n}=o.detail;if(console.log(`[DEBUG] ${e} - FormManager state changed to:`,n),"ready"===n){console.log(`[DEBUG] ${e} - FormManager is ready, updating button status`);const o=a?.oauth2?.[e],n=c?.oauth2?.[e];h(e,o,n)}}),n.addEventListener("submit",async o=>{o.preventDefault();const{data:t,submitButton:i}=o.detail,r=t.provider,d=i?.getAttribute("data-action");console.log(`[DEBUG] ${e} - Form submitted. Action:`,d,"Provider:",r);try{if("connect"===d)await async function(e){const o=c?.oauth2?.[e];if(!o||!1===o.enabled)throw new Error("This connection service is not available.");const n=o.scope||[],t=await(0,s.A)(l(),{method:"POST",timeout:3e4,response:"json",tries:2,body:{command:"user:oauth2",payload:{redirect:!1,provider:e,state:"authorize",scope:n,referrer:window.location.href}}});if(console.log("OAuth connect response:",t),!t.url)throw new Error(t.message||"Failed to get authorization URL");window.location.href=t.url}(r);else if("disconnect"===d){const e=await async function(e){const o=e.charAt(0).toUpperCase()+e.slice(1);if(await new Promise(e=>setTimeout(e,1)),!confirm(`Are you sure you want to disconnect your ${o} account?`))throw new Error("Disconnection cancelled");const n=(c?.oauth2?.[e]||{}).scope||[],t=await(0,s.A)(l(),{method:"POST",timeout:3e4,response:"json",tries:2,body:{command:"user:oauth2",payload:{redirect:!1,provider:e,state:"deauthorize",scope:n,referrer:window.location.href}}});if(console.log("OAuth disconnect response:",t),t.success)return a.oauth2&&a.oauth2[e]&&delete a.oauth2[e],!0;throw new Error(t.message||"Failed to disconnect")}(r);if(e){n.setFormState("ready");const e=c?.oauth2?.[r];h(r,null,e)}}}catch(e){n.showError(e),n.setFormState("ready")}})}(e);const o=n[e];console.log(`[DEBUG] ${e} - userConnection:`,o),console.log(`[DEBUG] ${e} - About to update provider status`),h(e,o,d)}else console.log(`[DEBUG] ${e} - Provider disabled, adding d-none class`),u.classList.add("d-none")});const u=document.getElementById("connections-empty");u&&(i?u.classList.add("d-none"):u.classList.remove("d-none"))}function h(e,o,n){console.log(`[DEBUG] updateProviderStatus() called for ${e}`),console.log(`[DEBUG] ${e} - userConnection:`,o),console.log(`[DEBUG] ${e} - userConnection truthy:`,!!o),console.log(`[DEBUG] ${e} - userConnection.identity:`,o?.identity),console.log(`[DEBUG] ${e} - providerSettings:`,n);const t=document.getElementById(`${e}-connection-status`),s=document.getElementById(`${e}-connection-description`),i=document.getElementById(`connection-form-${e}`),c=i?.querySelector('button[data-action="connect"]'),a=i?.querySelector('button[data-action="disconnect"]');console.log(`[DEBUG] ${e} - DOM elements found:`,{$status:!!t,$description:!!s,$form:!!i,$connectButton:!!c,$disconnectButton:!!a});const r=o&&o.identity;if(console.log(`[DEBUG] ${e} - isConnected:`,r),s){const o={google:"Enable single sign-on with your Google account",discord:"Connect to access Discord community features",github:"Link your GitHub account for repository access",twitter:"Share updates and connect with Twitter",facebook:"Connect your Facebook account for social features"},t=n?.description||o[e]||`Connect your ${e.charAt(0).toUpperCase()+e.slice(1)} account`;s.textContent=t,s.classList.remove("d-none")}if(t)if(r){const e=(d=o)&&d.identity?d.identity.global_name||d.identity.username||d.identity.name||d.identity.email||d.identity.id||"Connected":"Unknown";let n=`Connected: ${e}`;o.updated&&o.updated.timestamp&&(n=`${e} â€¢ ${new Date(o.updated.timestamp).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`),t.textContent=n,t.classList.remove("d-none")}else t.textContent="",t.classList.add("d-none");var d;c&&a&&(console.log(`[DEBUG] ${e} - Updating buttons. isConnected:`,r),r?(c.classList.add("d-none"),a.classList.remove("d-none"),console.log(`[DEBUG] ${e} - Showing disconnect button`)):(c.classList.remove("d-none"),a.classList.add("d-none"),console.log(`[DEBUG] ${e} - Showing connect button`)))}function f(){a&&c&&m()}}}]);